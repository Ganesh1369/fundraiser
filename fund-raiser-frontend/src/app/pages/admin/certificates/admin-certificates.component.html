<header class="admin-header">
    <h1>80G Certificates</h1>
</header>

<div class="filters">
    <button class="btn btn-primary btn-export" (click)="exportCertificates()">
        <lucide-icon name="download" [size]="16"></lucide-icon> Export Excel
    </button>
</div>

<div class="card">
    @if (certificates.length === 0) {
    <div class="empty-state">
        <lucide-icon name="file-text" class="empty-icon" [size]="40"></lucide-icon>
        <h3>No Certificate Requests</h3>
        <p>When organizations request 80G certificates, they will appear here.</p>
    </div>
    } @else {
    <div class="table-wrapper">
        <table class="data-table">
            <thead>
                <tr>
                    <th>User</th>
                    <th>Email</th>
                    <th>PAN</th>
                    <th>Donation</th>
                    <th>Requested</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @for (cert of certificates; track cert.id) {
                <tr>
                    <td>{{ cert.userName }}</td>
                    <td>{{ cert.userEmail }}</td>
                    <td class="pan-cell">{{ cert.panNumber }}</td>
                    <td class="amount">{{ cert.donationAmount ? formatCurrency(cert.donationAmount) : '-' }}</td>
                    <td>{{ formatDate(cert.requestedAt) }}</td>
                    <td><span class="status-badge" [ngClass]="getCertStatusClass(cert.status)">{{ cert.status }}</span></td>
                    <td class="action-cell">
                        @if (cert.status === 'pending') {
                        <button class="btn-action approve"
                            (click)="updateCertificateStatus(cert.id, 'approved')"><lucide-icon name="check" [size]="14"></lucide-icon> Approve</button>
                        <button class="btn-action reject"
                            (click)="updateCertificateStatus(cert.id, 'rejected')"><lucide-icon name="x" [size]="14"></lucide-icon> Reject</button>
                        } @else if (cert.status === 'approved') {
                        <span class="action-status approved"><lucide-icon name="check" [size]="14"></lucide-icon> Approved</span>
                        } @else if (cert.status === 'rejected') {
                        <span class="action-status rejected"><lucide-icon name="x" [size]="14"></lucide-icon> Rejected</span>
                        } @else {
                        <span class="action-status processing"><lucide-icon name="clock" [size]="14"></lucide-icon> Processing</span>
                        }
                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>
    @if (pagination.totalPages > 1) {
    <div class="pagination">
        <button [disabled]="pagination.page === 1" (click)="loadCertificates(pagination.page - 1)" class="btn-page">Previous</button>
        <span class="page-info">Page {{ pagination.page }} of {{ pagination.totalPages }}</span>
        <button [disabled]="pagination.page === pagination.totalPages" (click)="loadCertificates(pagination.page + 1)" class="btn-page">Next</button>
    </div>
    }
    }
</div>
