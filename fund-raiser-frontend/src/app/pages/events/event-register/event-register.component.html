<div class="min-h-screen bg-cover bg-center bg-no-repeat bg-fixed" style="background-image: url('/vivid-blurred-colorful-background.jpg')" *ngIf="event" [ngClass]="'theme-' + event.event_type">
    <!-- Header -->
    <div class="bg-primary/90 backdrop-blur-md px-5 py-6 text-white">
        <a [routerLink]="['/events', event.id]" class="text-sm text-white/80 hover:text-white no-underline">&larr; Back</a>
        <div class="max-w-2xl mx-auto text-center mt-3">
            <span class="inline-block px-3 py-1 bg-white/20 rounded-full text-xs font-semibold uppercase tracking-wider mb-2">{{ event.event_type }}</span>
            <h1 class="text-2xl md:text-3xl font-bold mb-1">Register for {{ event.event_name }}</h1>
            <p class="text-sm opacity-90 m-0"><lucide-icon name="calendar" class="w-4 h-4 inline-block align-middle"></lucide-icon> {{ event.event_date | date:'fullDate' }} &bull; <lucide-icon name="map-pin" class="w-4 h-4 inline-block align-middle"></lucide-icon> {{ event.event_location }}</p>
        </div>
    </div>

    <!-- Form -->
    <div class="max-w-2xl mx-auto px-5 py-8">
        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

            @if (errorMessage) {
            <div class="flex items-center gap-2 px-4 py-3 bg-red-50 border border-red-100 rounded-xl text-red-700 text-sm mb-6">
                <lucide-icon name="alert-triangle" class="w-4 h-4 shrink-0"></lucide-icon> {{ errorMessage }}
            </div>
            }

            <!-- Account Information -->
            <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl p-5 sm:p-6 mb-5 shadow-elevated">
                <h3 class="text-base font-semibold text-accent mb-4 pb-2 border-b border-primary/20 inline-block">Account Information</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Full Name *</label>
                        <input type="text" formControlName="name"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="Your full name">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Register As</label>
                        <select formControlName="user_type"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm text-neutral-900 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all">
                            <option value="individual">Individual</option>
                            <option value="student">Student</option>
                            <option value="organization">Organization</option>
                        </select>
                    </div>
                </div>
                <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-4 mt-4">
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Email *</label>
                        <input type="email" formControlName="email"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="you&#64;example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Phone *</label>
                        <input type="tel" formControlName="phone"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="10-digit number">
                    </div>
                    <div class="sm:col-span-2 md:col-span-1">
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Password *</label>
                        <div class="relative">
                            <input [type]="showPassword ? 'text' : 'password'" formControlName="password"
                                class="w-full px-4 py-3 pr-12 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                                placeholder="Min 6 characters">
                            <button type="button" (click)="showPassword = !showPassword"
                                class="absolute right-3 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600 transition-colors">
                                @if (showPassword) {
                                <lucide-icon name="eye-off" class="w-5 h-5"></lucide-icon>
                                } @else {
                                <lucide-icon name="eye" class="w-5 h-5"></lucide-icon>
                                }
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Personal Details -->
            <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl p-5 sm:p-6 mb-5 shadow-elevated">
                <h3 class="text-base font-semibold text-accent mb-4 pb-2 border-b border-primary/20 inline-block">Personal Details</h3>
                <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Date of Birth *</label>
                        <input type="text" formControlName="date_of_birth" appFlatpickr [fpConfig]="{ maxDate: 'today' }"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="Select date">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Gender *</label>
                        <select formControlName="gender"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all">
                            <option value="">Select</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Blood Group</label>
                        <input type="text" formControlName="blood_group"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="e.g., O+">
                    </div>
                </div>
            </div>

            <!-- Emergency Contact -->
            <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl p-5 sm:p-6 mb-5 shadow-elevated">
                <h3 class="text-base font-semibold text-accent mb-4 pb-2 border-b border-primary/20 inline-block">Emergency Contact</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Contact Name *</label>
                        <input type="text" formControlName="emergency_contact_name"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="Contact person">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Contact Phone *</label>
                        <input type="tel" formControlName="emergency_contact_phone"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="Phone number">
                    </div>
                </div>
            </div>

            <!-- Participation -->
            <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl p-5 sm:p-6 mb-5 shadow-elevated">
                <h3 class="text-base font-semibold text-accent mb-4 pb-2 border-b border-primary/20 inline-block">Participation</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">Experience Level</label>
                        <select formControlName="experience_level"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all">
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">T-Shirt Size</label>
                        <select formControlName="tshirt_size"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all">
                            <option value="">Select</option>
                            <option value="XS">XS</option>
                            <option value="S">S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                            <option value="XXL">XXL</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Medical -->
            <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl p-5 sm:p-6 mb-5 shadow-elevated">
                <h3 class="text-base font-semibold text-accent mb-4 pb-2 border-b border-primary/20 inline-block">Medical Information</h3>
                <div>
                    <label class="block text-sm font-medium text-neutral-600 mb-1.5">Medical Conditions / Allergies</label>
                    <textarea formControlName="medical_conditions" rows="3"
                        class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all resize-y"
                        placeholder="Any medical conditions we should know about..."></textarea>
                </div>
            </div>

            <!-- Address -->
            <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl p-5 sm:p-6 mb-5 shadow-elevated">
                <h3 class="text-base font-semibold text-accent mb-4 pb-2 border-b border-primary/20 inline-block">Address</h3>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-neutral-600 mb-1.5">Full Address</label>
                    <input type="text" formControlName="address"
                        class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                        placeholder="Street address">
                </div>
                <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">City</label>
                        <input type="text" formControlName="city"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="City">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">State</label>
                        <input type="text" formControlName="state"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="State">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-neutral-600 mb-1.5">PIN Code</label>
                        <input type="text" formControlName="pincode"
                            class="w-full px-4 py-3 bg-white border border-neutral-200 shadow-sm rounded-xl text-sm placeholder-neutral-400 focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"
                            placeholder="PIN code">
                    </div>
                </div>
            </div>

            <!-- Consent -->
            <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-2xl p-6 mb-6 shadow-elevated flex flex-col gap-3">
                <label class="flex items-start gap-3 text-sm text-neutral-700 cursor-pointer">
                    <input type="checkbox" formControlName="fitness_declaration" class="mt-0.5 w-4 h-4 accent-primary">
                    <span>I declare that I am medically fit to participate in this event *</span>
                </label>
                <label class="flex items-start gap-3 text-sm text-neutral-700 cursor-pointer">
                    <input type="checkbox" formControlName="terms_accepted" class="mt-0.5 w-4 h-4 accent-primary">
                    <span>I accept the terms and conditions *</span>
                </label>
            </div>

            <!-- Submit -->
            <div class="text-center pb-8">
                <button type="submit" [disabled]="registerForm.invalid || submitting"
                    class="w-full md:w-auto px-10 py-3.5 bg-primary text-white font-semibold rounded-xl hover:bg-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2 mx-auto">
                    @if (submitting) {
                    <span class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></span>
                    Registering...
                    } @else {
                    Complete Registration
                    }
                </button>
            </div>
        </form>
    </div>
</div>
